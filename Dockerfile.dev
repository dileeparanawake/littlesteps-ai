# Set base image
# Adjust NODE_VERSION as desired
ARG NODE_VERSION=20.19.3
FROM node:${NODE_VERSION}-alpine AS base

# Set working directory
WORKDIR /app

# Install pnpm
ARG PNPM_VERSION=10.13.1
RUN npm install -g pnpm@$PNPM_VERSION

# Copy only package manager files first (for better caching)
COPY package.json pnpm-lock.yaml ./

# Install dependencies
RUN pnpm install --frozen-lockfile

# Copy rest of your app
COPY . .

# Expose the port the app runs on
EXPOSE 3000

# Default command (for dev or prod)
CMD ["pnpm", "dev"]